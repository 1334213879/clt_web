{include file="common/head"/}


<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script>
$(function() {    
    var socket;
    var readyState = ["connecting", "connected", "closing", "closed"];
    /* 打开连接事件 */
    $("#open").click(function() {
        try {
             /* 连接 */
             socket = new WebSocket("ws://127.0.0.1:8282");
             
             /* 绑定事件 */
             socket.onopen = function() {
                 $("#msg").html("连接成功...");
             };
             
            socket.onmessage = function(e) {
                // console.log(e)
                 $("#msg").html($("#msg").html() + "<br />" + e.data);
             };
             
             socket.onclose = function() {
                 $("#msg").html($("#msg").html() + "<br />关闭连接...");
             };
        } catch(exception) {
            $("#msg").html($("#msg").html() + "<br />有错误发生");
        }
    });
    
    /* 发送数据事件 */
    $("#send").click(function() {
        /* 检查文本框是否为空 */
        if($("#data").val() == "") {
            alert("请输入数据！");
            return;
        }
   
        try {
            socket.send($("#data").val());
            $("#msg").html($("#msg").html() + "<br />发送数据：" + $("#data").val());
        } catch (exception) {
            $("#msg").html($("#msg").html() + "<br />发送数据出错");
        }
        
        /* 清空文本框 */
        $("#data").val("");
    });
    
    /* 断开连接 */
    $("#off").click(function() {
        socket.close();
    });
});
</script>
<!DOCTYPE html>
<html>
<head>
    <title>聊天室</title>
</head>
<body>
    <div style="width: 100%;height: 70px;background-color: blue">
        <div>某某某公司</div>
    </div>
    <div style="width: 100%;height: 100px;">
        <p id="msg">
			
        </p>
    </div>
    <div>
        <button id="open">开启链接</button>
        <input type="text" name="content" id="data">
        <button id="send">发送</button>
        <button id="off">断开</button>
    </div>

</body>
</html>
{include file="common/footer"/}